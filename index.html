<!DOCTYPE html>
<html>
<head>
    <title>Hexagon HÃ¼pfspiel</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: black;
        }
        canvas {
            display: block;
        }
        #score {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            font-size: 20px;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <div id="score">Punkte: 0</div>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const hexagon = {
            x: canvas.width / 2,
            y: canvas.height / 2,
            radius: 150,
            rotation: 0,
            rotationSpeed: 0.002,
            sides: 6,
            color: 'lightblue'
        };

        const ball = {
            x: canvas.width / 2,
            y: canvas.height / 2,
            radius: 15,
            vx: 1,
            vy: 1,
            gravity: 0.2,
            friction: 0.99,
            color: 'red'
        };

        let score = 0;
        let lastTimestamp = 0;

        function update(timestamp) {
            const deltaTime = (timestamp - lastTimestamp) / 1000;
            lastTimestamp = timestamp;

            hexagon.rotation += hexagon.rotationSpeed;
            ball.vy += ball.gravity;
            ball.vx *= ball.friction;
            ball.vy *= ball.friction;
            ball.x += ball.vx;
            ball.y += ball.vy;

            checkCollisions();
            draw();

            score += deltaTime;
            document.getElementById('score').textContent = `Punkte: ${Math.floor(score)}`;

            requestAnimationFrame(update);
        }

        function checkCollisions() {
            const vertices = getHexagonVertices();
            for (let i = 0; i < hexagon.sides; i++) {
                const start = vertices[i];
                const end = vertices[(i + 1) % hexagon.sides];
                if (checkLineCollision(start, end, { x: ball.x, y: ball.y, radius: ball.radius })) {
                    const normal = { x: end.y - start.y, y: start.x - end.x };
                    const normalLength = Math.sqrt(normal.x * normal.x + normal.y * normal.y);
                    normal.x /= normalLength;
                    normal.y /= normalLength;
                    const dotProduct = ball.vx * normal.x + ball.vy * normal.y;
                    ball.vx -= 2 * dotProduct * normal.x;
                    ball.vy -= 2 * dotProduct * normal.y;
                }
            }
        }

        function getHexagonVertices() {
            const vertices = [];
            for (let i = 0; i < hexagon.sides; i++) {
                const angle = hexagon.rotation + (2 * Math.PI * i) / hexagon.sides;
                const x = hexagon.x + hexagon.radius * Math.cos(angle);
                const y = hexagon.y + hexagon.radius * Math.sin(angle);
                vertices.push({ x, y });
            }
            return vertices;
        }

        function checkLineCollision(start, end, circle) {
            const dx = end.x - start.x;
            const dy = end.y - start.y;
            const lengthSquared = dx * dx + dy * dy;
            const t = Math.max(0, Math.min(1, ((circle.x - start.x) * dx + (circle.y - start.y) * dy) / lengthSquared));
            const closestPoint = {
                x: start.x + t * dx,
                y: start.y + t * dy
            };
            const distanceSquared = Math.pow(circle.x - closestPoint.x, 2) + Math.pow(circle.y - closestPoint.y, 2);
            return distanceSquared <= circle.radius * circle.radius;
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawHexagon();
            drawBall();
        }

        function drawHexagon() {
            const vertices = getHexagonVertices();
            ctx.beginPath();
            ctx.moveTo(vertices[0].x, vertices[0].y);
            for (let i = 1; i < hexagon.sides; i++) {
                ctx.lineTo(vertices[i].x, vertices[i].y);
            }
            ctx.closePath();
            ctx.strokeStyle = hexagon.color;
            ctx.lineWidth = 3;
            ctx.stroke();
        }

        function drawBall() {
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
            ctx.fillStyle = ball.color;
            ctx.fill();
        }

        canvas.addEventListener('click', (event) => {
            const dx = event.clientX - ball.x;
            const dy = event.clientY - ball.y;
            const length = Math.sqrt(dx * dx + dy * dy);
            ball.vx += (dx / length) * 10;
            ball.vy += (dy / length) * 10;
        });

        update(0);
    </script>
</body>
</html>
