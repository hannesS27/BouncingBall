<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bouncing Ball in Rotating Hexagon</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: black;
        }
        canvas {
            display: block;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    
    <script>
        const canvas = document.getElementById("canvas");
        const ctx = canvas.getContext("2d");

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const gravity = 0.2; 
        const friction = 0.99; 
        let angle = 0; 
        let ball = {
            x: canvas.width / 2,
            y: canvas.height / 2 - 100,
            radius: 10,
            dx: 2,
            dy: 1
        };
        
        function getHexagonVertices(cx, cy, size, rotation) {
            let vertices = [];
            for (let i = 0; i < 6; i++) {
                let theta = ((Math.PI / 3) * i) + rotation;
                let x = cx + size * Math.cos(theta);
                let y = cy + size * Math.sin(theta);
                vertices.push({ x, y });
            }
            return vertices;
        }

        function drawHexagon(cx, cy, size, rotation) {
            const vertices = getHexagonVertices(cx, cy, size, rotation);
            ctx.beginPath();
            ctx.moveTo(vertices[0].x, vertices[0].y);
            for (let i = 1; i < 6; i++) {
                ctx.lineTo(vertices[i].x, vertices[i].y);
            }
            ctx.closePath();
            ctx.strokeStyle = "white";
            ctx.lineWidth = 3;
            ctx.stroke();
        }

        function drawBall() {
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
            ctx.fillStyle = "red";
            ctx.fill();
            ctx.closePath();
        }

        function checkCollision(hexVertices) {
            for (let i = 0; i < 6; i++) {
                let v1 = hexVertices[i];
                let v2 = hexVertices[(i + 1) % 6];

                let edge = { x: v2.x - v1.x, y: v2.y - v1.y };
                let ballToEdge = { x: ball.x - v1.x, y: ball.y - v1.y };

                let edgeLength = Math.sqrt(edge.x * edge.x + edge.y * edge.y);
                let edgeNormal = { x: edge.y / edgeLength, y: -edge.x / edgeLength };

                let distance = Math.abs(ballToEdge.x * edgeNormal.x + ballToEdge.y * edgeNormal.y);

                if (distance < ball.radius) {
                    let dotProduct = ball.dx * edgeNormal.x + ball.dy * edgeNormal.y;
                    ball.dx -= 2 * dotProduct * edgeNormal.x;
                    ball.dy -= 2 * dotProduct * edgeNormal.y;
                    ball.dy *= friction;
                    return;
                }
            }
        }

        function update() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            let hexCenter = { x: canvas.width / 2, y: canvas.height / 2 };
            let hexSize = 150;
            let hexVertices = getHexagonVertices(hexCenter.x, hexCenter.y, hexSize, angle);

            drawHexagon(hexCenter.x, hexCenter.y, hexSize, angle);
            drawBall();

            ball.dy += gravity;
            ball.x += ball.dx;
            ball.y += ball.dy;
            ball.dy *= friction;
            ball.dx *= friction;

            checkCollision(hexVertices);

            angle += 0.02;

            requestAnimationFrame(update);
        }

        update();
    </script>
</body>
</html>
